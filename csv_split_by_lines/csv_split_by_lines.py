#!/usr/bin/python3# -*- coding: utf-8 -*-import pandas as pdimport os# =======读取当前路径下的CSV文件名称至list中=====cur_path = os.getcwd()file_list = os.listdir(cur_path)# print(file_list)file_csv = []for file in file_list:    if ".csv" in file:        file_csv.append(file)# print(file_csv)# ====创建保持路径try:    # date_today = datetime.datetime.now().strftime("%Y%m%d")    Save_dir = os.path.join(os.getcwd(), "Split_Result")    if not os.path.exists(Save_dir):        os.mkdir(Save_dir)        print("The save directory is created successfully in the current path!")    else:        print("The save directory is already exist!")except:    print("Run Error!")# =====将读取的CSV文件名称清单转换为字典类型存储，用于输入索引进行选择====file_csv_dict = dict(enumerate(file_csv))print("The current directory csv file list is as the following:\n", file_csv_dict)select_csv_index = int(input("Please input the file index number for split:\n"))print("The Selected csv file is:", file_csv_dict[select_csv_index])# try :#    if select_csv_index is in(file_csv_dict.key)# ====基于输入的索引，读取对应CSV文件内容======data_csv = pd.read_csv(    file_csv_dict[select_csv_index], sep=",", header=0, index_col=False, encoding="gbk")# print(data_csv.head(3))split_rows = int(input("Please input the split Rows:\n"))# ======对读取的CSV文件新增row_num列，基于整除输入的行数，进行分组====data_csv["row_num"] = [x // split_rows for x in list(data_csv.index)]# print(data_csv)# =====通过集合获取分组编号，用于后续按分组编号进行分组筛选======file_group = list(set(data_csv["row_num"]))print("The split group is:\n", file_group)# =====按分组编号进行内容筛选，分别存入已编号命名的新CSV文件中，保持在当前路径下total_rows = 0for group in file_group:    # print(group)    data_split = data_csv[data_csv["row_num"] == group]    # print(data_split)    file_part = os.path.join(        Save_dir, str(file_csv_dict[select_csv_index])[:-4] + "_" + str(group) + ".csv"    )    data_split = data_split.copy()    data_split.drop(["row_num"], axis=1, inplace=True)    data_split.to_csv(file_part, index=False, encoding="gbk")    rows_all = data_split.shape[0]    total_rows += rows_all    print(        "The split part{} is saving,the rows in the file is {}:".format(group, rows_all)    )print("The total rows is:", total_rows)input("Press the Enter Key to  Exit!")